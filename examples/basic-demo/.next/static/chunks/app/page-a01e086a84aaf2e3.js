(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{3854:function(e,t,n){Promise.resolve().then(n.bind(n,5064))},5064:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return es}});var r,a,o,i=n(7437),s=n(4811),l=n(2881),d=n(229),c=n(9969),u=n(2265),p=n(3218),h=n(937),m=Object.defineProperty,g=Object.getOwnPropertyNames,f=(e,t)=>function(){return e&&(t=(0,e[g(e)[0]])(e=0)),t},v=f({"src/lib/utils.ts"(){}});function y(e){let{className:t,variant:n,size:r,asChild:a=!1,...c}=e,u=a?d.g7:"button";return(0,i.jsx)(u,{"data-slot":"button",className:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,l.m6)((0,s.W)(t))}(o({variant:n,size:r,className:t})),...c})}((e,t)=>{for(var n in t)m(e,n,{get:t[n],enumerable:!0})})({},{Button:()=>y,buttonVariants:()=>o});var E=f({"components/ui/button.tsx"(){v(),o=(0,c.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}})}});function N(e){var t;return{...e,props:e.props?{...e.props}:void 0,bindings:e.bindings?{...e.bindings}:void 0,events:e.events?{...e.events}:void 0,children:null===(t=e.children)||void 0===t?void 0:t.map(e=>N(e))}}function b(e,t){if(e){if(e.id===t)return e;if(e.children)for(let n of e.children){let e=b(n,t);if(e)return e}}}function T(e,t,n){var r;let a=N(e),o=function e(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=[...r,t];if(t.id===n)return a;if(t.children)for(let r of t.children){let t=e(r,n,a);if(t)return t}return null}(a,t);if(!o)return a;let i=n(o[o.length-1]);if(1===o.length)return i;let s=o[o.length-2],l={...s,children:null===(r=s.children)||void 0===r?void 0:r.map(e=>e.id===t?i:e)};return 2===o.length?l:T(a,s.id,()=>l)}function x(e,t){var n,r,a,o,i,s,l;switch(t.type){case"UI_EVENT":return{...e,loading:!0,history:[...e.history,t.event]};case"AI_RESPONSE":return{...e,layout:t.node,loading:!1,error:void 0};case"PARTIAL_UPDATE":if(!e.layout||"root"===t.nodeId||t.nodeId===e.layout.id)return{...e,layout:t.node,loading:!1,error:void 0};return{...e,layout:(n=e.layout,r=t.nodeId,a=t.node,T(n,r,()=>a)),loading:!1,error:void 0};case"ADD_NODE":if(!e.layout)return e;return{...e,layout:(o=e.layout,i=t.parentId,s=t.node,l=t.index,T(o,i,e=>{let t=e.children?[...e.children]:[];return void 0!==l&&l>=0&&l<=t.length?t.splice(l,0,s):t.push(s),{...e,children:t}})),loading:!1,error:void 0};case"REMOVE_NODE":if(!e.layout)return e;return{...e,layout:function(e,t){let n=N(e);if(n.id===t)throw Error("Cannot remove root node");let r=function e(t,n){if(t.children){if(t.children.some(e=>e.id===n))return t;for(let r of t.children){let t=e(r,n);if(t)return t}}return null}(n,t);return r?T(n,r.id,e=>{var n;return{...e,children:null===(n=e.children)||void 0===n?void 0:n.filter(e=>e.id!==t)}}):n}(e.layout,t.nodeId),loading:!1,error:void 0};case"LOADING":return{...e,loading:t.isLoading};case"ERROR":return{...e,error:t.message,loading:!1};default:return e}}var I={loading:!0,history:[]},R=((r=R||{}).FULL_REFRESH="FULL_REFRESH",r.UPDATE_NODE="UPDATE_NODE",r.ADD_DROPDOWN="ADD_DROPDOWN",r.SHOW_DETAIL="SHOW_DETAIL",r.HIDE_DETAIL="HIDE_DETAIL",r.TOGGLE_STATE="TOGGLE_STATE",r.UPDATE_FORM="UPDATE_FORM",r.NAVIGATE="NAVIGATE",r),A=class{registerRoute(e,t){this.routes[e]||(this.routes[e]=[]),this.routes[e].push(t)}resolveRoute(e,t,n,r,a,o){var i;let s;let l=this.routes[e.type]||[];if(0===l.length)return{actionType:"FULL_REFRESH",targetNodeId:(null==n?void 0:n.id)||"root",plannerInput:{schema:t,goal:a,history:[e],userContext:o},prompt:'Generate a new UI for the goal: "'.concat(a,'". The user just triggered: ').concat(e.type," on node ").concat(e.nodeId)};let d=n?b(n,e.nodeId):void 0,c=null==d?void 0:null===(i=d.events)||void 0===i?void 0:i[e.type];c&&(s=l.find(e=>e.actionType.toString()===c.action)),s||(s=l[0]);let u=(null==c?void 0:c.target)||s.targetNodeId||e.nodeId,p={};if(s.contextKeys&&s.contextKeys.forEach(e=>{p[e]=r[e]}),d&&(p.sourceNode=d),n){let e=b(n,u);e&&(p.targetNode=e)}e.payload&&(p.eventPayload=e.payload),(null==c?void 0:c.payload)&&Object.entries(c.payload).forEach(e=>{let[t,n]=e;p[t]=n});let h={schema:t,goal:a,history:[e],userContext:{...o,...p}},m=this.processTemplate(s.promptTemplate,{goal:a,eventType:e.type,nodeId:e.nodeId,targetNodeId:u,actionType:s.actionType,...p});return{actionType:s.actionType,targetNodeId:u,plannerInput:h,prompt:m}}processTemplate(e,t){return e.replace(/\${(\w+)}/g,(e,n)=>void 0!==t[n]?String(t[n]):"${".concat(n,"}"))}constructor(){this.routes={}}},_=p.z.enum(["CLICK","CHANGE","SUBMIT","MOUSEOVER","MOUSEOUT","FOCUS","BLUR"]),O=p.z.object({type:_,nodeId:p.z.string(),timestamp:p.z.number().nullable(),payload:p.z.record(p.z.unknown()).nullable()});p.z.enum(["AI_RESPONSE","ERROR"]);var S=p.z.object({}).catchall(p.z.string()),D=p.z.object({id:p.z.string(),node_type:p.z.string(),props:S.nullable(),bindings:S.nullable(),events:p.z.record(p.z.string(),p.z.object({action:p.z.string(),target:p.z.string(),payload:S.nullable()})).nullable(),children:p.z.array(p.z.any()).nullable()}),w=D.omit({children:!0}),j=D.extend({children:p.z.array(w).nullable()}),k=D.extend({children:p.z.array(j).nullable()}),L=D.extend({children:p.z.array(k).nullable()});p.z.discriminatedUnion("type",[p.z.object({type:p.z.literal("UI_EVENT"),event:O}),p.z.object({type:p.z.literal("AI_RESPONSE"),node:L}),p.z.object({type:p.z.literal("PARTIAL_UPDATE"),nodeId:p.z.string(),node:L}),p.z.object({type:p.z.literal("ADD_NODE"),parentId:p.z.string(),node:L,index:p.z.number().nullable()}),p.z.object({type:p.z.literal("REMOVE_NODE"),nodeId:p.z.string()}),p.z.object({type:p.z.literal("ERROR"),message:p.z.string()}),p.z.object({type:p.z.literal("LOADING"),isLoading:p.z.boolean()})]),p.z.object({layout:L.nullable(),loading:p.z.boolean(),history:p.z.array(O),error:p.z.string().nullable()}),p.z.object({schema:p.z.record(p.z.unknown()),goal:p.z.string(),history:p.z.array(O).nullable(),userContext:p.z.record(p.z.unknown()).nullable()});var P=((a=P||{}).PLAN_START="PLAN_START",a.PLAN_PROMPT_CREATED="PLAN_PROMPT_CREATED",a.PLAN_RESPONSE_CHUNK="PLAN_RESPONSE_CHUNK",a.PLAN_COMPLETE="PLAN_COMPLETE",a.PLAN_ERROR="PLAN_ERROR",a.BINDING_RESOLUTION_START="BINDING_RESOLUTION_START",a.BINDING_RESOLUTION_COMPLETE="BINDING_RESOLUTION_COMPLETE",a.DATA_FETCH_START="DATA_FETCH_START",a.DATA_FETCH_COMPLETE="DATA_FETCH_COMPLETE",a.RENDER_START="RENDER_START",a.RENDER_COMPLETE="RENDER_COMPLETE",a.PREFETCH_START="PREFETCH_START",a.PREFETCH_COMPLETE="PREFETCH_COMPLETE",a),C=new class{on(e,t){var n;return this.listeners[e]||(this.listeners[e]=[]),null===(n=this.listeners[e])||void 0===n||n.push(t),()=>{if(this.listeners[e]){var n;this.listeners[e]=null===(n=this.listeners[e])||void 0===n?void 0:n.filter(e=>e!==t)}}}async emit(e){for(let t of this.listeners[e.type]||[])await t(e)}constructor(){this.listeners={}}};function z(e,t){return{type:e,timestamp:Date.now(),...t}}function U(e,t,n){let{schema:r,goal:a,history:o,userContext:i}=e,s=Object.entries(r).map(e=>{let[t,n]=e;return"Table: ".concat(t,"\nSchema: ").concat(JSON.stringify(n))}).join("\n\n"),l=(null==o?void 0:o.slice(-5).map(e=>"Event: ".concat(e.type," on node ").concat(e.nodeId).concat(e.payload?" with payload ".concat(JSON.stringify(e.payload)):"")).join("\n"))||"No recent events",d=i?"\n\nUser Context:\n".concat(JSON.stringify(i)):"";return n||'\nYou are an expert UI generator. \nCreate a user interface that achieves the following goal: "'.concat(a,'"\n\nAvailable data schema:\n').concat(s,"\n\nRecent user interactions:\n").concat(l).concat(d,"\n\nGenerate a complete UI specification in JSON format that matches the following TypeScript type:\ntype UISpecNode = {\n  id: string;\n  node_type: string;\n  props?: Record<string, unknown>;\n  bindings?: Record<string, unknown>;\n  events?: Record<string, { action: string; target: string; payload?: Record<string, unknown>; }};\n  children?: UISpecNode[];\n};\n\nUI Guidance:\n1. Create a focused interface that directly addresses the goal\n2. Use appropriate UI patterns (lists, forms, details, etc.)\n3. Include navigation between related views when needed\n4. Keep the interface simple and intuitive\n5. Bind to schema data where appropriate\n6. Provide event handlers for user interactions - make sure to always include both action and target properties\n\nRespond ONLY with the JSON UI specification and no other text.\n  ")}function M(e,t,n){return{id:t||"root",node_type:"Container",props:{className:"p-4"},children:[{id:"header-1",node_type:"Header",props:{title:"Task Management Dashboard",className:"mb-6"}},{id:"list-view",node_type:"ListView",props:{selectable:!0},bindings:{items:e.schema.tasks?e.schema.tasks.sampleData||[]:[{id:"1",title:"Example Task 1",status:"pending"},{id:"2",title:"Example Task 2",status:"completed"}],fields:[{key:"id",label:"ID"},{key:"title",label:"Title"},{key:"status",label:"Status"}]},events:{onSelect:{action:"SELECT_ITEM",target:"detail-view",payload:{source:"list-view"}}}}]}}(0,h.J)({compatibility:"strict"});var H=e=>{let[t,n]=(0,u.useState)("{}"),[r,a]=(0,u.useState)(!1),[o,i]=(0,u.useState)(null);return{append:async e=>{try{a(!0),n("{}")}catch(e){i(e instanceof Error?e:Error(String(e)))}finally{a(!1)}},data:{content:t},isLoading:r,error:o,stop:()=>{}}};p.z.enum(["Container","Card","Header","Button","Input","Select","Textarea","Checkbox","RadioGroup","ListView","Detail","Tabs","Dialog","Heading","Text"]);var G=()=>(0,i.jsx)("div",{className:"w-full h-8 bg-gray-200 animate-pulse rounded"}),F=e=>{let{rows:t=3}=e;return(0,i.jsxs)("div",{className:"w-full space-y-2",children:[(0,i.jsx)("div",{className:"w-full h-10 bg-gray-200 animate-pulse rounded"}),Array.from({length:t}).map((e,t)=>(0,i.jsx)("div",{className:"w-full h-12 bg-gray-200 animate-pulse rounded"},t))]})},V=()=>(0,i.jsxs)("div",{className:"w-full p-4 space-y-4 border rounded-lg",children:[(0,i.jsx)("div",{className:"w-3/4 h-6 bg-gray-200 animate-pulse rounded"}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("div",{className:"w-full h-4 bg-gray-200 animate-pulse rounded"}),(0,i.jsx)("div",{className:"w-full h-4 bg-gray-200 animate-pulse rounded"}),(0,i.jsx)("div",{className:"w-5/6 h-4 bg-gray-200 animate-pulse rounded"})]})]}),B=e=>(0,i.jsx)("div",{className:"w-full ".concat(e.className||""),style:e.style,children:e.children}),$=e=>{let{title:t,className:n}=e;return(0,i.jsx)("header",{className:"py-4 px-6 border-b mb-4 ".concat(n||""),children:(0,i.jsx)("h1",{className:"text-xl font-semibold",children:t})})},K=e=>{let{onClick:t,children:n,variant:r="default"}=e;return(0,i.jsx)("button",{className:"px-4 py-2 rounded font-medium ".concat("default"===r?"bg-blue-600 text-white":"outline"===r?"border border-gray-300 text-gray-700":"bg-red-600 text-white"),onClick:t,children:n})},J=e=>{let{items:t=[],fields:n=[],onSelect:r,selectable:a}=e;return(0,i.jsx)("div",{className:"w-full border rounded-lg overflow-hidden",children:(0,i.jsxs)("table",{className:"w-full",children:[(0,i.jsx)("thead",{className:"bg-gray-50",children:(0,i.jsx)("tr",{children:n.map(e=>(0,i.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.label},e.key))})}),(0,i.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map((e,t)=>(0,i.jsx)("tr",{onClick:()=>a&&r&&r(e),className:a?"cursor-pointer hover:bg-gray-50":"",children:n.map(t=>(0,i.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e[t.key]},t.key))},t))})]})})},W=e=>{let{data:t,fields:n=[],title:r,visible:a=!0,onBack:o}=e;return a?(0,i.jsxs)("div",{className:"w-full border rounded-lg p-6 space-y-4",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[r&&(0,i.jsx)("h2",{className:"text-lg font-medium",children:r}),o&&(0,i.jsx)(K,{variant:"outline",onClick:o,children:"Back"})]}),(0,i.jsx)("div",{className:"space-y-4",children:n.map(e=>"heading"===e.type?(0,i.jsx)("h3",{className:"text-xl font-semibold",children:null==t?void 0:t[e.key]},e.key):"content"===e.type?(0,i.jsx)("div",{className:"text-sm text-gray-700",children:null==t?void 0:t[e.key]},e.key):(0,i.jsxs)("div",{className:"flex flex-col",children:[e.label&&(0,i.jsx)("span",{className:"text-xs text-gray-500",children:e.label}),(0,i.jsx)("span",{className:"text-sm",children:null==t?void 0:t[e.key]})]},e.key))})]}):null},Z=(e,t)=>{var n;let r=null===(n=e.events)||void 0===n?void 0:n[t];if(r)return()=>{console.log("Event triggered: ".concat(t," on node ").concat(e.id),{action:r.action,target:r.target,payload:r.payload})}},q={Container:e=>{var t,n,r;return(0,i.jsx)(B,{style:null===(t=e.props)||void 0===t?void 0:t.style,className:null===(n=e.props)||void 0===n?void 0:n.className,children:null===(r=e.children)||void 0===r?void 0:r.map(e=>Y(e))})},Header:e=>{var t,n;return(0,i.jsx)($,{title:(null===(t=e.props)||void 0===t?void 0:t.title)||"Untitled",className:null===(n=e.props)||void 0===n?void 0:n.className})},Button:e=>{var t,n;return(0,i.jsx)(K,{variant:null===(t=e.props)||void 0===t?void 0:t.variant,onClick:Z(e,"onClick"),children:(null===(n=e.props)||void 0===n?void 0:n.label)||"Button"})},ListView:e=>{var t,n,r;return(0,i.jsx)(J,{items:(null===(t=e.bindings)||void 0===t?void 0:t.items)||[],fields:(null===(n=e.bindings)||void 0===n?void 0:n.fields)||[],selectable:null===(r=e.props)||void 0===r?void 0:r.selectable,onSelect:Z(e,"onSelect")})},Detail:e=>{var t,n,r,a;return(0,i.jsx)(W,{data:null===(t=e.bindings)||void 0===t?void 0:t.data,fields:(null===(n=e.bindings)||void 0===n?void 0:n.fields)||[],title:null===(r=e.props)||void 0===r?void 0:r.title,visible:(null===(a=e.props)||void 0===a?void 0:a.visible)!==!1,onBack:Z(e,"onBack")})}};function Y(e){var t;let n=q[e.node_type];return n?n(e):(0,i.jsxs)("div",{className:"p-2 border border-red-300 rounded",children:[(0,i.jsxs)("p",{className:"text-sm text-red-500",children:["Unsupported component: ",e.node_type]}),null===(t=e.children)||void 0===t?void 0:t.map(e=>Y(e))]})}var Q=new Map;async function X(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"shadcn",r=Date.now(),a=e.id,o=Q.get(a);if(o&&r-o.timestamp<5e3)return o.element;if(await C.emit(z("RENDER_START",{layout:e})),"shadcn"===n||console.warn("Unsupported adapter: ".concat(n,", falling back to shadcn")),t=Y(e),await C.emit(z("RENDER_COMPLETE",{layout:e,renderTimeMs:Date.now()-r})),Q.set(a,{element:t,timestamp:r}),Q.size>10){let e=[...Q.entries()].sort((e,t)=>{let[,n]=e,[,r]=t;return n.timestamp-r.timestamp})[0][0];Q.delete(e)}return t}var ee=new Map,et=new Map;function en(e,t,n){let r={...e},a=t.split("."),o=r;for(let e=0;e<a.length-1;e++){let t=a[e];t in o&&null!==o[t]&&void 0!==o[t]||(o[t]={}),"object"!=typeof(o=o[t])&&(o={})}return o[a[a.length-1]]=n,r}async function er(e,t){var n;let r=Date.now(),a=(n=e.id,"".concat(n,":").concat(JSON.stringify(t))),o=ee.get(a),i=et.get(a);if(o&&i&&r-i<2e3)return o;await C.emit(z("BINDING_RESOLUTION_START",{layout:e}));let s={...e,props:e.props?{...e.props}:void 0,events:e.events?{...e.events}:void 0};if(e.bindings)for(let[n,r]of Object.entries(e.bindings)){let e=function e(t,n){if("string"==typeof t)return function(e,t){let n=t.split("."),r=e;for(let e of n){if(null==r||"object"!=typeof r)return;r=r[e]}return r}(n,t);if(Array.isArray(t))return t.map(t=>e(t,n));if(null!==t&&"object"==typeof t){let r={};for(let[a,o]of Object.entries(t))r[a]=e(o,n);return r}return t}(r,t);void 0!==e&&(s.props||(s.props={}),s.props[n]=e)}if(e.children&&(s.children=await Promise.all(e.children.map(e=>er(e,t)))),await C.emit(z("BINDING_RESOLUTION_COMPLETE",{originalLayout:e,resolvedLayout:s})),ee.set(a,s),et.set(a,r),ee.size>50){let e=[...et.entries()];if(e.length>0){e.sort((e,t)=>e[1]-t[1]);let t=e[0][0];ee.delete(t),et.delete(t)}}return s}var ea=class{register(e,t){return"all"===e?(this.hooks.all||(this.hooks.all=[]),this.hooks.all.push(t),()=>{this.hooks.all&&(this.hooks.all=this.hooks.all.filter(e=>e!==t))}):(e.forEach(e=>{var n;this.hooks[e]||(this.hooks[e]=[]),null===(n=this.hooks[e])||void 0===n||n.push(t)}),()=>{e.forEach(e=>{if(this.hooks[e]){var n;this.hooks[e]=null===(n=this.hooks[e])||void 0===n?void 0:n.filter(e=>e!==t)}})})}async processEvent(e){let t=!1,n=!1,r={originalEvent:e,preventDefault:()=>{t=!0},stopPropagation:()=>{n=!0},isDefaultPrevented:()=>t,isPropagationStopped:()=>n};if(this.hooks.all){for(let e of this.hooks.all)if(await e(r),n)break}if(!n&&this.hooks[e.type]){for(let t of this.hooks[e.type]||[])if(await t(r),n)break}return!t}constructor(){this.hooks={}}},eo=e=>{let{schema:t,goal:n,componentAdapter:r="shadcn",userContext:a,onEvent:o,eventHooks:s,systemEventHooks:l,debugMode:d=!1,mockMode:c=!0,databaseConfig:p,planningConfig:h,integration:m={},scope:g={},enablePartialUpdates:f=!1}=e,[v,y]=(0,u.useState)(null),[N,b]=(0,u.useState)({}),[T,R]=(0,u.useState)(!0);(0,u.useEffect)(()=>{"shadcn"===r&&R(function(){try{return E(),!0}catch(e){return!1}}())},[r]),(0,u.useEffect)(()=>{let e=[];if(l&&Object.entries(l).forEach(t=>{let[n,r]=t;r&&r.forEach(t=>{let r=C.on(n,t);e.push(r)})}),d){let t=e=>{console.debug("[AutoUI Debug] System Event:",e)};Object.values(P).filter(e=>"RENDER_START"!==e&&"BINDING_RESOLUTION_START"!==e).forEach(n=>{let r=C.on(n,t);e.push(r)})}return()=>{e.forEach(e=>e())}},[l,d]),(0,u.useEffect)(()=>{(async()=>{let e={};v?e=await v.initializeDataContext():t&&Object.entries(t).forEach(t=>{let[n,r]=t;e[n]={schema:r,data:(null==r?void 0:r.sampleData)||[],selected:null}}),a&&(e.user=a),b(e)})()},[t,v,a]);let{state:_,handleEvent:O}=function(e){let{schema:t,goal:n,userContext:r,mockMode:a=!1,planningConfig:o={},router:i=function(){let e=new A;return e.registerRoute("CLICK",{actionType:"FULL_REFRESH",targetNodeId:"root",promptTemplate:'Generate a new UI for the goal: "${goal}". The user just clicked on node ${nodeId}'}),e.registerRoute("CLICK",{actionType:"SHOW_DETAIL",targetNodeId:"${targetNodeId}",promptTemplate:"Update the UI to show details for the selected item. Current node: ${nodeId}, Target node: ${targetNodeId}",contextKeys:["selected"]}),e.registerRoute("CLICK",{actionType:"NAVIGATE",targetNodeId:"root",promptTemplate:"Navigate to a new view based on the user clicking ${nodeId}. Current goal: ${goal}"}),e.registerRoute("CLICK",{actionType:"ADD_DROPDOWN",targetNodeId:"${targetNodeId}",promptTemplate:"Add a dropdown menu to node ${targetNodeId} with options relevant to the clicked element ${nodeId}"}),e.registerRoute("CLICK",{actionType:"TOGGLE_STATE",targetNodeId:"${nodeId}",promptTemplate:"Toggle the state of node ${nodeId} (e.g., expanded/collapsed, selected/unselected)"}),e.registerRoute("CHANGE",{actionType:"UPDATE_FORM",targetNodeId:"${targetNodeId}",promptTemplate:"Update the form based on the user changing the value of ${nodeId}"}),e}(),dataContext:s={},enablePartialUpdates:l=!1}=e,[d,c]=(0,u.useReducer)(x,I),{append:p,data:h,isLoading:m,error:g,stop:f}=H(),v=(0,u.useCallback)(e=>{if(c({type:"UI_EVENT",event:e}),f(),l){let o=i.resolveRoute(e,t,d.layout,s,n,r);if(o){if(console.log("Resolved route:",o),C.emit(z("PLAN_START",{plannerInput:o.plannerInput})),a){let e=M(o.plannerInput,o.targetNodeId,o.prompt);switch(o.actionType){case"FULL_REFRESH":c({type:"AI_RESPONSE",node:e});break;case"UPDATE_NODE":case"SHOW_DETAIL":case"HIDE_DETAIL":case"TOGGLE_STATE":case"ADD_DROPDOWN":case"UPDATE_FORM":case"NAVIGATE":c({type:"PARTIAL_UPDATE",nodeId:o.targetNodeId,node:e})}}else{let e=o.prompt;C.emit(z("PLAN_PROMPT_CREATED",{prompt:e})),p({content:e,role:"user"}),sessionStorage.setItem("currentRoute",JSON.stringify({actionType:o.actionType,targetNodeId:o.targetNodeId}))}return}}let o={schema:t,goal:n,history:[...d.history,e],userContext:r};a?c({type:"AI_RESPONSE",node:M(o)}):p({content:U(o),role:"user"})},[p,n,t,d.history,d.layout,f,r,i,a,s,l]);return(0,u.useEffect)(()=>{if(m)c({type:"LOADING",isLoading:!0});else if(g)c({type:"ERROR",message:g instanceof Error?g.message:String(g)}),C.emit(z("PLAN_ERROR",{error:g instanceof Error?g:Error(String(g))}));else if(h.content&&"{}"!==h.content)try{C.emit(z("PLAN_RESPONSE_CHUNK",{chunk:h.content,isComplete:!0}));let e=(h.content.match(/```(?:json)?\s*([\s\S]*?)\s*```/)||[null,h.content])[1].trim(),t=JSON.parse(e),n=L.parse(t),r=sessionStorage.getItem("currentRoute");if(r&&l)try{let e=JSON.parse(r);switch(e.actionType){case"FULL_REFRESH":default:c({type:"AI_RESPONSE",node:n});break;case"UPDATE_NODE":case"SHOW_DETAIL":case"HIDE_DETAIL":case"TOGGLE_STATE":case"ADD_DROPDOWN":case"UPDATE_FORM":case"NAVIGATE":c({type:"PARTIAL_UPDATE",nodeId:e.targetNodeId,node:n})}sessionStorage.removeItem("currentRoute")}catch(e){console.error("Error parsing route info:",e),c({type:"AI_RESPONSE",node:n})}else c({type:"AI_RESPONSE",node:n});C.emit(z("PLAN_COMPLETE",{layout:n,executionTimeMs:0}))}catch(e){console.error("Failed to parse LLM response:",e),c({type:"ERROR",message:"Failed to parse LLM response"}),C.emit(z("PLAN_ERROR",{error:e instanceof Error?e:Error("Parse error")}))}},[h.content,g,m,l]),(0,u.useEffect)(()=>{let e={schema:t,goal:n,history:[],userContext:r};a?c({type:"AI_RESPONSE",node:M(e)}):p({content:U(e),role:"user"})},[p,n,t,r,a]),{state:d,dispatch:c,handleEvent:v}}({schema:t,goal:n,userContext:a,mockMode:c,planningConfig:h,router:void 0,dataContext:N,enablePartialUpdates:f}),S=(0,u.useRef)(new ea);(0,u.useEffect)(()=>{if(!s)return;let e=[];if(s.all){let t=S.current.register("all",async e=>{for(let t of s.all||[])if(await t(e),e.isPropagationStopped())break});e.push(t)}return Object.entries(s).forEach(t=>{let[n,r]=t;if("all"===n||!r)return;let a=S.current.register([n],async e=>{for(let t of r)if(await t(e),e.isPropagationStopped())break});e.push(a)}),()=>{e.forEach(e=>e())}},[s]),(0,u.useCallback)(async e=>{var t;let n=await S.current.processEvent(e);if(o&&o(e),!n){console.info("Event processing was prevented by hooks",e);return}let r=(e,t)=>{if(e){if(e.id===t)return e;if(e.children)for(let n of e.children){let e=r(n,t);if(e)return e}}},a=r(_.layout,e.nodeId);if(!a){console.warn("Node not found for event: ".concat(e.nodeId)),O(e);return}let i=null===(t=a.events)||void 0===t?void 0:t[e.type];if(!i){console.warn("No event config found for ".concat(e.type," on node ").concat(e.nodeId)),O(e);return}b(function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};arguments.length>4&&arguments[4];let a={...r};switch(e){case"VIEW_DETAIL":(null==n?void 0:n.item)&&(a=en(a,"selected",n.item));break;case"HIDE_DETAIL":a=en(a,"selected",null);break;case"SET_VALUE":(null==n?void 0:n.path)&&"value"in n&&(a=en(a,String(n.path),n.value));break;default:console.warn("Unknown action: ".concat(e))}return a}(i.action,i.target||"",{...i.payload,...e.payload},N,_.layout||void 0)),O(e)},[N,O,o,_.layout]);let[D,w]=(0,u.useState)(void 0),[j,k]=(0,u.useState)(null),B=(0,u.useCallback)(async()=>{if(_.layout)try{let e=await er(_.layout,N);w(e)}catch(e){console.error("Error resolving bindings:",e)}else w(void 0)},[_.layout,N]);(0,u.useEffect)(()=>{B()},[B]);let $=(0,u.useCallback)(async()=>{if(D)try{let e=await X(D,r);k(e)}catch(e){console.error("Error rendering node:",e)}else k(null)},[D,r]);return((0,u.useEffect)(()=>{$()},[$]),T)?(0,i.jsxs)("div",{className:"autoui-root ".concat(m.className||""),id:m.id,"data-mode":m.mode,"data-scope":(null==g?void 0:g.type)||"full",children:[_.loading||!D?(0,i.jsx)("div",{className:"autoui-loading",children:_.layout?function e(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"shadcn";if(!t)return(0,i.jsx)(G,{});switch(t.type){case"ListView":return(0,i.jsx)(F,{rows:3});case"Detail":return(0,i.jsx)(V,{});case"Container":var r;return(0,i.jsx)("div",{className:"space-y-4",children:null===(r=t.children)||void 0===r?void 0:r.map((t,r)=>(0,i.jsx)("div",{children:e(t,n)},r))});default:return(0,i.jsx)(G,{})}}(_.layout,r):(0,i.jsxs)("div",{className:"autoui-shimmer-container",children:[(0,i.jsx)("div",{className:"autoui-shimmer-header"}),(0,i.jsx)("div",{className:"autoui-shimmer-content"})]})}):(0,i.jsx)("div",{className:"autoui-content",children:j}),_.error&&(0,i.jsxs)("div",{className:"autoui-error",children:[(0,i.jsx)("p",{className:"autoui-error-title",children:"Error generating UI"}),(0,i.jsx)("p",{className:"autoui-error-message",children:_.error})]})]}):(0,i.jsxs)("div",{className:"autoui-error p-4 border border-red-300 bg-red-50 text-red-700 rounded",children:[(0,i.jsx)("p",{className:"font-medium",children:"Component Library Not Found"}),(0,i.jsx)("p",{className:"text-sm whitespace-pre-line",children:"Missing required shadcn components. Please run:\n> npm run setup-shadcn"})]})};let ei={tasks:{tableName:"tasks",columns:{id:{type:"uuid",primaryKey:!0},title:{type:"text",notNull:!0},description:{type:"text"},status:{type:"text",notNull:!0,default:"pending"},priority:{type:"text",notNull:!0,default:"medium"},dueDate:{type:"date"},createdAt:{type:"timestamp",notNull:!0,default:"now()"},updatedAt:{type:"timestamp"}},sampleData:[{id:"1",title:"Setup development environment",description:"Install Node.js, TypeScript, and VS Code",status:"completed",priority:"high",dueDate:"2023-12-31",createdAt:"2023-12-01T10:00:00Z",updatedAt:"2023-12-01T15:30:00Z"},{id:"2",title:"Create project structure",description:"Set up initial files and directories",status:"completed",priority:"high",dueDate:"2023-12-31",createdAt:"2023-12-02T09:15:00Z",updatedAt:"2023-12-02T11:45:00Z"},{id:"3",title:"Implement core features",description:"Work on the main functionality",status:"in_progress",priority:"medium",dueDate:"2024-01-15",createdAt:"2023-12-05T08:30:00Z",updatedAt:"2023-12-10T14:20:00Z"},{id:"4",title:"Write documentation",description:"Create README and API docs",status:"pending",priority:"low",dueDate:"2024-01-31",createdAt:"2023-12-15T16:45:00Z",updatedAt:null}]},users:{tableName:"users",columns:{id:{type:"uuid",primaryKey:!0},name:{type:"text",notNull:!0},email:{type:"text",notNull:!0,unique:!0},role:{type:"text",notNull:!0,default:"user"},createdAt:{type:"timestamp",notNull:!0,default:"now()"}},sampleData:[{id:"1",name:"John Doe",email:"john@example.com",role:"admin",createdAt:"2023-10-01T00:00:00Z"},{id:"2",name:"Jane Smith",email:"jane@example.com",role:"user",createdAt:"2023-10-15T08:30:00Z"},{id:"3",name:"Bob Johnson",email:"bob@example.com",role:"user",createdAt:"2023-11-05T14:45:00Z"}]}};function es(){return(0,i.jsxs)("main",{className:"container mx-auto p-4",children:[(0,i.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"AutoUI React Example"}),(0,i.jsx)("div",{className:"border rounded-lg p-4 bg-white dark:bg-gray-800 dark:border-gray-700 min-h-[500px]",children:(0,i.jsx)(eo,{schema:ei,goal:"Create a task management dashboard with list view and ability to view task details",mockMode:!1,debugMode:!1,componentAdapter:"shadcn",userContext:{id:"1",name:"John Doe",role:"admin"},onEvent:()=>{},eventHooks:{},systemEventHooks:{},databaseConfig:{},planningConfig:{}})})]})}}},function(e){e.O(0,[154,971,117,744],function(){return e(e.s=3854)}),_N_E=e.O()}]);